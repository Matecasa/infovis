<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>TP · Presentación de Gráficos</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#f7f9fc; --card:#fff; --text:#0f172a; --muted:#475569; --border:#e5e7eb;
    --accent:#4f46e5; --radius:16px; --gap:18px; --shadow:0 10px 28px rgba(15,23,42,.09);
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--text);font-family:Inter,system-ui,Arial,sans-serif}
  header{padding:28px 16px 6px;text-align:center}
  h1{margin:0 0 6px;font-size:clamp(26px,4.2vw,40px)}
  p.lead{margin:0 auto 6px;max-width:900px;color:var(--muted)}
  main{max-width:1200px;margin:16px auto 40px;padding:0 16px}
  .grid{display:grid;gap:22px;grid-template-columns:1fr}
  @media(min-width:990px){ .grid{grid-template-columns:repeat(2,1fr)} }

  .card{
    background:var(--card);border:1px solid var(--border);border-radius:var(--radius);
    box-shadow:var(--shadow);padding:14px;display:flex;flex-direction:column;gap:10px
  }
  .card h2{margin:2px 6px 0;font-size:18px}
  .toolbar{display:flex;gap:8px;flex-wrap:wrap;margin:0 6px}
  .btn{
    padding:8px 12px;border:1px solid var(--border);border-radius:10px;background:#fff;color:var(--text);
    cursor:pointer;font-weight:600
  }
  .btn:hover{outline:2px solid #e0e7ff}

  
  .embed{
    position:relative;border:1px solid var(--border);border-radius:12px;overflow:hidden;background:#fff;
    aspect-ratio: 16 / 10;   
  }
  .embed .inner{position:absolute;inset:0}
  .embed iframe{position:absolute;inset:0;width:100%;height:100%;border:0;display:block}

  /* RAWGraphs */
  .raw-stage{display:flex;align-items:center;justify-content:center;background:#fff}
  .raw-holder{transform-origin:50% 50%; width:100%; height:100%; display:flex; align-items:center; justify-content:center}
  #rawsvg{max-width:100%;max-height:100%;width:100%;height:100%;display:block}
  .range{vertical-align:middle;margin-left:6px}
  .hint{color:var(--muted);font-size:12px;margin:0 6px}

  footer{color:var(--muted);text-align:center;padding:20px 16px 32px;font-size:13px}
</style>
</head>
<body>
  <header>
    <h1>Gastos Personales: Junio, Julio y Agosto</h1>
    
  </header>

  <main>
    <section class="grid">
      <!-- Flourish -->
      <article class="card" id="card-flourish">
        <h2>Flourish · Jerarquía</h2>
        <div class="toolbar">
          <button class="btn" data-fs="#card-flourish">Pantalla completa</button>
          <a class="btn" href="https://public.flourish.studio/visualisation/25147256/" target="_blank" rel="noopener">Abrir en Flourish</a>
        </div>
        <div class="embed"><div class="inner">
          <div class="flourish-embed flourish-hierarchy" data-src="visualisation/25147256"></div>
        </div></div>
      </article>

      <!-- RAWGraphs -->
      <article class="card" id="card-raw">
        <h2>RAWGraphs · Diagrama (SVG)</h2>
        <div class="toolbar">
          <button class="btn" data-fs="#card-raw">Pantalla completa</button>
          <label class="btn">Zoom
            <input id="rawZoom" class="range" type="range" min="50" max="150" value="100">
          </label>
          <button class="btn" id="rawReset">Reset</button>
        </div>
        <div class="embed raw-stage">
          <div class="inner raw-holder" id="rawHolder">
            <!-- ======= REEMPLAZÁ ESTE SVG POR TU EXPORT DE RAWGRAPHS (mantener id="rawsvg") ======= -->
            <svg id="rawsvg" viewBox="0 0 800 600" xmlns="http://www.w3.org/2000/svg">
              <rect width="100%" height="100%" fill="#ffffff"/>
              <text x="50%" y="50%" text-anchor="middle" dominant-baseline="middle"
                    font-family="Inter, Arial, sans-serif" font-size="18" fill="#64748b">
                Pegá aquí tu SVG de RAWGraphs (reemplazá este bloque)
              </text>
            </svg>
            <!-- ============================ FIN PEGAR SVG ============================ -->
          </div>
        </div>
        <p class="hint">Los cuatro embeds ahora comparten la misma relación de aspecto (16:10).</p>
      </article>

      <!-- Datawrapper -->
      <article class="card" id="card-dw">
        <h2>Datawrapper · Gastos</h2>
        <div class="toolbar">
          <button class="btn" data-fs="#card-dw">Pantalla completa</button>
        </div>
        <div class="embed"><div class="inner">
          <iframe title="Gastos totales" aria-label="Bar Chart" id="datawrapper-chart-Ad1jv"
                  src="https://datawrapper.dwcdn.net/Ad1jv/1/" scrolling="no"></iframe>
        </div></div>
      </article>

      <!-- Power BI -->
      <article class="card" id="card-pbi">
        <h2>Power BI · Dashboard</h2>
        <div class="toolbar">
          <button class="btn" data-fs="#card-pbi">Pantalla completa</button>
        </div>
        <div class="embed"><div class="inner">
          <iframe title="TP"
                  src="https://app.powerbi.com/view?r=eyJrIjoiMmZkNDI4NTktMmU2YS00ZjcxLTgyMDItNmQ0YTQzNTY1OGNkIiwidCI6ImExZjUwYTk3LTIxYzAtNDlhNy1hOWQ0LWYyNDRlYmI0MmRhNyIsImMiOjR9"
                  allowfullscreen></iframe>
        </div></div>
      </article>
    </section>
  </main>

  <footer>© 2025 • InfoVis • GitHub Pages</footer>

  <script src="https://public.flourish.studio/resources/embed.js" defer></script>

  <!-- Fullscreen por tarjeta -->
  <script>
    document.querySelectorAll('[data-fs]').forEach(btn=>{
      btn.addEventListener('click',()=>{
        const el = document.querySelector(btn.getAttribute('data-fs'));
        if (el?.requestFullscreen) el.requestFullscreen();
      });
    });
  </script>

  <!-- Auto-resize Datawrapper -->
  <script>
    (function(){
      "use strict";
      window.addEventListener("message", function(e){
        if (e.data["datawrapper-height"] !== undefined) {
          var iframes = document.querySelectorAll("iframe");
          for (var id in e.data["datawrapper-height"]) {
            for (var i=0;i<iframes.length;i++){
              if (iframes[i].contentWindow === e.source) {
                iframes[i].style.height = e.data["datawrapper-height"][id] + "px";
              }
            }
          }
        }
      });
    })();
  </script>

  <!-- RAWGraphs: responsivo + zoom -->
  <script>
    (function(){
      const holder = document.getElementById('rawHolder');
      const zoom   = document.getElementById('rawZoom');
      const reset  = document.getElementById('rawReset');

      const applyZoom = v => holder.style.transform = `scale(${v/100})`;
      zoom.addEventListener('input', e=> applyZoom(+e.target.value));
      reset.addEventListener('click', ()=> { zoom.value=100; applyZoom(100); });

      function makeResponsive(svg){
        if (!svg) return;
        if (!svg.getAttribute('viewBox')) {
          const w = parseFloat(svg.getAttribute('width'))  || 1600;
          const h = parseFloat(svg.getAttribute('height')) || 900;
          svg.setAttribute('viewBox', `0 0 ${w} ${h}`);
        }
        svg.removeAttribute('width'); svg.removeAttribute('height');
        svg.setAttribute('preserveAspectRatio','xMidYMid meet');
        svg.style.maxWidth='100%'; svg.style.maxHeight='100%';
        svg.style.width='100%'; svg.style.height='100%';
        try{
          const b = svg.getBBox();
          if (b && b.width>0 && b.height>0) {
            const pad = Math.max(b.width,b.height)*0.02;
            svg.setAttribute('viewBox', `${b.x-pad} ${b.y-pad} ${b.width+2*pad} ${b.height+2*pad}`);
          }
        }catch(e){}
      }

      function init(){
        const svg = document.getElementById('rawsvg');
        makeResponsive(svg);
        applyZoom(100);
      }
      init();
    })();
  </script>
</body>
</html>
