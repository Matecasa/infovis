<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mis gastos – Nuevo tablero 2×2</title>
  <meta name="description" content="Tablero responsive con 2 gráficos arriba y 2 abajo, estilo limpio y fondo claro." />
  <style>
    :root{
      --bg: #fcfcfe;        /* fondo MUY claro */
      --ink: #0f172a;       /* texto casi negro */
      --sub: #475569;       /* texto secundario */
      --card: #ffffff;      /* tarjetas */
      --ring: #e6e8ef;      /* bordes sutiles */
      --accent: #2563eb;    /* acento minimal */
      --radius: 16px;
      --shadow: 0 12px 30px rgba(2,6,23,.08);
      --maxw: 1280px;
    }
    *{ box-sizing:border-box }
    html,body{ height:100% }
    body{
      margin:0; background:var(--bg); color:var(--ink);
      font: 16px/1.55 Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial;
    }

    /* CABECERA nueva, minimal */
    .hero{
      max-width:var(--maxw); margin:24px auto 8px; padding:0 20px;
    }
    .hero h1{ margin:0 0 6px; font-size: clamp(1.25rem, 2vw + .5rem, 2rem); letter-spacing:.2px }
    .hero p{ margin:0; color:var(--sub) }

    /* GRID 2×2 fijo en desktop, stack en mobile */
    .container{ max-width:var(--maxw); margin:0 auto 48px; padding: 10px 20px; }
    .grid{
      display:grid; gap:18px;
      grid-template-columns: 1fr; /* mobile */
    }
    @media (min-width: 900px){
      .grid{ grid-template-columns: repeat(2, 1fr); } /* 2×2 */
    }

    /* Tarjetas nuevas con encabezado lateral */
    .card{
      display:flex; flex-direction:column; min-height:260px; background:var(--card);
      border:1px solid var(--ring); border-radius:var(--radius); box-shadow:var(--shadow);
      overflow:hidden; isolation:isolate;
    }
    .card .hd{
      display:flex; align-items:center; gap:10px; padding:12px 14px; border-bottom:1px solid var(--ring);
      background: linear-gradient(180deg, rgba(37,99,235,.05), transparent 80%);
    }
    .dot{ width:9px; height:9px; border-radius:999px; background:var(--accent); box-shadow:0 0 0 4px rgba(37,99,235,.12) }
    .title{ font-weight:800; font-size:1rem }
    .sub{ color:var(--sub); font-size:.9rem }

    .card .bd{ position:relative; padding:0; }

    /* Utilidades de relación de aspecto */
    .ratio{ position:relative; width:100%; }
    .ratio-16x9{ padding-top:56.25% }
    .ratio-4x3{ padding-top:75% }
    .ratio > iframe, .ratio > svg, .ratio > .flourish-embed > iframe{
      position:absolute; inset:0; width:100%; height:100%; border:0; display:block;
    }

    /* SVG espacioso */
    .svg-pad{ padding:12px }
    .svg-pad svg{ width:100%; height:auto; display:block }

    /* Footer minimal */
    footer{ max-width:var(--maxw); margin:8px auto 28px; padding:0 20px; color:var(--sub); font-size:.9rem }
  </style>
</head>
<body>
  <section class="hero">
    <h1>Tablero de gastos personales</h1>
    <p>Diseño renovado: <strong>dos gráficos arriba</strong> y <strong>dos abajo</strong>, alto contraste sobre fondo claro.</p>
  </section>

  <main class="container">
    <div class="grid" aria-label="Cuadrícula 2×2 de gráficos">

      <!-- ARRIBA IZQ: FLOURISH -->
      <article class="card" aria-labelledby="fl-title">
        <div class="hd">
          <span class="dot" aria-hidden="true"></span>
          <div>
            <div id="fl-title" class="title">Medios de pago y categorías</div>
            <div class="sub">Flourish (jerarquía)</div>
          </div>
        </div>
        <div class="bd">
          <div class="ratio ratio-4x3">
            <div class="flourish-embed flourish-hierarchy" data-src="visualisation/25147256"></div>
          </div>
        </div>
      </article>

      <!-- ARRIBA DER: DATAWRAPPER -->
      <article class="card" aria-labelledby="dw-title">
        <div class="hd">
          <span class="dot" aria-hidden="true"></span>
          <div>
            <div id="dw-title" class="title">Gastos totales</div>
            <div class="sub">Datawrapper (barras)</div>
          </div>
        </div>
        <div class="bd">
          <div class="ratio ratio-4x3">
            <iframe
              id="datawrapper-chart-Ad1jv"
              title="Gastos totales"
              src="https://datawrapper.dwcdn.net/Ad1jv/1/"
              loading="lazy"
              referrerpolicy="no-referrer-when-downgrade"></iframe>
          </div>
        </div>
      </article>

      <!-- ABAJO IZQ: SVG ESTÁTICO -->
      <article class="card" aria-labelledby="svg-title">
        <div class="hd">
          <span class="dot" aria-hidden="true"></span>
          <div>
            <div id="svg-title" class="title">Distribución detallada</div>
            <div class="sub">SVG estático (escalable)</div>
          </div>
        </div>
        <div class="bd svg-pad">
          <!-- Pega tu SVG completo; mantengo viewBox para que sea fluido -->
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 805 600" role="img" aria-label="Diagrama SVG de gastos">
            <rect width="805" height="600" x="0" y="0" fill="#FFFFFF"/>
            <!-- === CONTENIDO ORIGINAL DEL <g id="viz"> Y <g id="labels"> AQUÍ === -->
            <!-- Para no duplicar miles de caracteres en edición, sustituí esto por tu bloque original completo -->
          </svg>
        </div>
      </article>

      <!-- ABAJO DER: POWER BI -->
      <article class="card" aria-labelledby="pbi-title">
        <div class="hd">
          <span class="dot" aria-hidden="true"></span>
          <div>
            <div id="pbi-title" class="title">Reporte interactivo</div>
            <div class="sub">Power BI (16:9)</div>
          </div>
        </div>
        <div class="bd">
          <div class="ratio ratio-16x9">
            <iframe
              title="Tp 1"
              src="https://app.powerbi.com/view?r=eyJrIjoiMmZkNDI4NTktMmU2YS00ZjcxLTgyMDItNmQ0YTQzNTY1OGNkIiwidCI6ImExZjUwYTk3LTIxYzAtNDlhNy1hOWQ0LWYyNDRlYmI0MmRhNyIsImMiOjR9"
              allowfullscreen
              loading="lazy"
              referrerpolicy="no-referrer-when-downgrade"></iframe>
          </div>
        </div>
      </article>

    </div>
  </main>

  <footer>
    Fondo claro · texto negro · diseño 2×2. <span id="fecha"></span>
  </footer>

  <!-- Librería de Flourish -->
  <script src="https://public.flourish.studio/resources/embed.js" defer></script>
  <!-- Auto-resize oficial de Datawrapper -->
  <script>
    window.addEventListener("message", function(e){
      if (typeof e.data["datawrapper-height"] !== "undefined"){
        const iframes = document.querySelectorAll("iframe");
        for (const id in e.data["datawrapper-height"]) {
          for (let i=0; i<iframes.length; i++){
            if (iframes[i].contentWindow === e.source){ iframes[i].style.height = e.data["datawrapper-height"][id] + "px"; }
          }
        }
      }
    });
    // Fecha
    (function(){
      const el=document.getElementById('fecha');
      if(!el) return; const d=new Date();
      el.textContent = `· Última edición: ${d.toLocaleDateString('es-AR',{day:'2-digit',month:'short',year:'numeric'})}`;
    })();
  </script>
</body>
</html>
